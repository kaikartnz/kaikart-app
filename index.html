    <script>
        // Data
        const restaurants = [
            {
                id: 1,
                name: "BurgerFuel Ponsonby",
                image: "https://images.unsplash.com/photo-1572802419224-296b0aeee0d9?w=800&auto=format&fit=crop",
                rating: 4.7,
                time: "20-30 min",
                delivery: "$3.99",
                category: "burgers",
                tags: ["Gourmet", "Kiwi Owned"],
                menu: [
                    { name: "Bastard Burger", price: 18.90, desc: "Beef, avocado, mango, bacon & aioli", image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400" },
                    { name: "Fuel Slider", price: 8.90, desc: "Mini burger with grass-fed beef", image: "https://images.unsplash.com/photo-1553979459-d2229ba7433b?w=400" },
                    { name: "Kumara Fries", price: 6.50, desc: "Sweet potato fries with aioli", image: "https://images.unsplash.com/photo-1630384060421-cb20d0e0649d?w=400" },
                    { name: "Shake", price: 7.90, desc: "Thick handmade shake", image: "https://images.unsplash.com/photo-1572490122747-3968b75cc699?w=400" }
                ]
            },
            {
                id: 2,
                name: "The White Lady",
                image: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=800&auto=format&fit=crop",
                rating: 4.5,
                time: "25-40 min",
                delivery: "$4.99",
                category: "burgers",
                tags: ["Late Night", "Iconic"],
                menu: [
                    { name: "Classic Cheeseburger", price: 14.50, desc: "Beef patty, cheese, pickles, secret sauce", image: "https://images.unsplash.com/photo-1551782450-a2132b4ba21d?w=400" },
                    { name: "Loaded Fries", price: 9.00, desc: "Cheese, bacon, sour cream & spring onions", image: "https://images.unsplash.com/photo-1585109649139-366815a0d713?w=400" }
                ]
            },
            {
                id: 3,
                name: "Hell Pizza K Rd",
                image: "https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?w=800&auto=format&fit=crop",
                rating: 4.6,
                time: "30-45 min",
                delivery: "$5.99",
                category: "pizza",
                tags: ["Spicy", "Vege Options"],
                menu: [
                    { name: "Pandemonium", price: 22.00, desc: "Pepperoni, bacon, ham & BBQ sauce", image: "https://images.unsplash.com/photo-1628840042765-356cda07504e?w=400" },
                    { name: "Sinister", price: 20.00, desc: "Chicken, cream cheese, cranberry & spring onion", image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=400" },
                    { name: "Double Chocolate Thunder", price: 12.00, desc: "Chocolate pizza dessert", image: "https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=400" }
                ]
            },
            {
                id: 4,
                name: "Auckland Fish Market",
                image: "https://images.unsplash.com/photo-1579208575657-c595a05383b7?w=800&auto=format&fit=crop",
                rating: 4.8,
                time: "15-25 min",
                delivery: "$2.99",
                category: "fish",
                tags: ["Fresh", "Local"],
                menu: [
                    { name: "Fish & Chips", price: 16.00, desc: "Hoki fillets with hand-cut chips", image: "https://images.unsplash.com/photo-1579208575657-c595a05383b7?w=400" },
                    { name: "Seafood Chowder", price: 12.00, desc: "Creamy chowder with fresh seafood", image: "https://images.unsplash.com/photo-1551248429-40975aa4de74?w=400" },
                    { name: "Oysters (Half Dozen)", price: 18.00, desc: "Fresh Pacific oysters", image: "https://images.unsplash.com/photo-1559339352-11d035aa65de?w=400" }
                ]
            },
            {
                id: 5,
                name: "Best Ugly Bagels",
                image: "https://images.unsplash.com/photo-1629115916087-7e8c114a24ed?w=800&auto=format&fit=crop",
                rating: 4.9,
                time: "10-20 min",
                delivery: "$3.99",
                category: "cafe",
                tags: ["Wellington", "Fresh"],
                menu: [
                    { name: "Salmon Bagel", price: 15.50, desc: "House-smoked salmon, cream cheese, capers", image: "https://images.unsplash.com/photo-1629115916087-7e8c114a24ed?w=400" },
                    { name: "Bacon & Egg", price: 13.50, desc: "Free-range egg, streaky bacon, tomato relish", image: "https://images.unsplash.com/photo-1525351484163-7529414344d8?w=400" },
                    { name: "Flat White", price: 5.00, desc: "Kiwi style coffee", image: "https://images.unsplash.com/photo-1572442388796-11668a67e53d?w=400" }
                ]
            },
            {
                id: 6,
                name: "Satya Spice",
                image: "https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=800&auto=format&fit=crop",
                rating: 4.7,
                time: "35-50 min",
                delivery: "$4.99",
                category: "indian",
                tags: ["Authentic", "Spicy"],
                menu: [
                    { name: "Butter Chicken", price: 24.00, desc: "Creamy tomato curry with naan", image: "https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=400" },
                    { name: "Lamb Rogan Josh", price: 26.00, desc: "Kashmiri style lamb curry", image: "https://images.unsplash.com/photo-1565557623262-b51c2513a641?w=400" },
                    { name: "Garlic Naan", price: 5.00, desc: "Fresh tandoor bread", image: "https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400" }
                ]
            },
            {
                id: 7,
                name: "The Sushi Train",
                image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=800&auto=format&fit=crop",
                rating: 4.4,
                time: "20-30 min",
                delivery: "$3.99",
                category: "sushi",
                tags: ["Quick", "Healthy"],
                menu: [
                    { name: "Salmon Nigiri (6pc)", price: 14.00, desc: "Fresh salmon on sushi rice", image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=400" },
                    { name: "Dragon Roll", price: 18.00, desc: "Eel, avocado, cucumber", image: "https://images.unsplash.com/photo-1559410545-0bdcd187e0a6?w=400" },
                    { name: "Miso Soup", price: 3.50, desc: "Traditional miso with tofu", image: "https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400" }
                ]
            },
            {
                id: 8,
                name: "Fairlie Bakehouse",
                image: "https://images.unsplash.com/photo-1621996346565-e3dbc646d9a9?w=800&auto=format&fit=crop",
                rating: 4.9,
                time: "15-25 min",
                delivery: "$4.99",
                category: "bakery",
                tags: ["South Island", "Famous"],
                menu: [
                    { name: "Bacon & Egg Pie", price: 9.50, desc: "NZ's best bacon & egg pie", image: "https://images.unsplash.com/photo-1621996346565-e3dbc646d9a9?w=400" },
                    { name: "Mince & Cheese", price: 8.50, desc: "Classic Kiwi mince pie", image: "https://images.unsplash.com/photo-1565557623262-b51c2513a641?w=400" },
                    { name: "Custard Square", price: 6.50, desc: "Vanilla custard with passionfruit icing", image: "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?w=400" }
                ]
            }
        ];
        
        // State
        let cart = [];
        let currentRestaurant = null;
        
        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }
        
        // Enter Food App
        function enterFoodApp() {
            showPage('foodApp');
            renderRestaurants(restaurants);
            setupCategories();
            setupSearch();
        }
        
        // Role Selection
        function selectRole(role) {
            document.body.className = `role-${role}`;
            
            if (role === 'eater') showPage('eaterSignup');
            else if (role === 'driver') showPage('driverSignup');
            else if (role === 'merchant') showPage('merchantSignup');
            else if (role === 'admin') showPage('adminDashboard');
        }
        
        function showRole(role) {
            document.querySelectorAll('.role-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`.role-card.${role}`).classList.add('active');
            
            const hero = document.getElementById('heroSection');
            const titles = {
                eater: { title: 'Craving Kiwi Favourites?', subtitle: 'Get your favourite local kai delivered fast.', btn1: 'Order Now', btn2: 'Create Account' },
                driver: { title: 'Drive & Earn with KaiKart', subtitle: 'Flexible hours, competitive pay, be your own boss.', btn1: 'Apply Now', btn2: 'Learn More' },
                merchant: { title: 'Grow Your Business', subtitle: 'Join NZ\'s fastest growing food delivery platform.', btn1: 'Partner With Us', btn2: 'View Pricing' },
                admin: { title: 'Platform Management', subtitle: 'Oversee operations, manage users, ensure quality.', btn1: 'Admin Login', btn2: 'Documentation' }
            };
            
            hero.querySelector('h1').textContent = titles[role].title;
            hero.querySelector('p').textContent = titles[role].subtitle;
            
            document.body.className = `role-${role}`;
        }
        
        // Render Restaurants
        function renderRestaurants(data) {
            const container = document.getElementById('restaurantList');
            container.innerHTML = data.map(r => `
                <div class="restaurant-card animate-in" onclick="openRestaurant(${r.id})">
                    <div style="position: relative;">
                        <img src="${r.image}" alt="${r.name}" class="restaurant-image">
                        ${r.tags.includes('Kiwi Owned') ? '<span class="restaurant-badge"><i class="fas fa-leaf"></i> Kiwi Owned</span>' : ''}
                        ${r.tags.includes('Iconic') ? '<span class="restaurant-badge" style="background: var(--secondary)"><i class="fas fa-star"></i> Iconic</span>' : ''}
                    </div>
                    <div class="restaurant-info">
                        <div class="restaurant-header">
                            <div>
                                <h3 class="restaurant-name">${r.name}</h3>
                                <div class="restaurant-meta">
                                    <span class="rating"><i class="fas fa-star"></i> ${r.rating}</span>
                                    <span>â€¢</span>
                                    <span>${r.category.charAt(0).toUpperCase() + r.category.slice(1)}</span>
                                    <span>â€¢</span>
                                    <span>${r.tags[0]}</span>
                                </div>
                            </div>
                        </div>
                        <div class="delivery-info">
                            <span><i class="fas fa-clock"></i> ${r.time}</span>
                            <span><i class="fas fa-motorcycle"></i> ${r.delivery} delivery</span>
                            <span><i class="fas fa-check-circle" style="color: var(--success)"></i> Open</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Setup Categories
        function setupCategories() {
            const items = document.querySelectorAll('.category-item');
            items.forEach(item => {
                item.addEventListener('click', () => {
                    items.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    const category = item.dataset.category;
                    if (category === 'all') {
                        renderRestaurants(restaurants);
                    } else {
                        const filtered = restaurants.filter(r => r.category === category);
                        renderRestaurants(filtered);
                    }
                });
            });
        }
        
        // Setup Search - THIS IS THE SEARCH FUNCTION
        function setupSearch() {
            const input = document.getElementById('searchInput');
            input.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = restaurants.filter(r => 
                    r.name.toLowerCase().includes(term) || 
                    r.category.toLowerCase().includes(term)
                );
                renderRestaurants(filtered);
            });
        }
        
        // Open Restaurant
        function openRestaurant(id) {
            const restaurant = restaurants.find(r => r.id === id);
            currentRestaurant = restaurant;
            
            document.getElementById('menuImage').src = restaurant.image;
            document.getElementById('menuRestaurantName').textContent = restaurant.name;
            document.getElementById('menuRating').textContent = restaurant.rating;
            document.getElementById('menuTime').textContent = restaurant.time;
            document.getElementById('menuDelivery').textContent = restaurant.delivery + ' delivery';
            
            const menuContainer = document.getElementById('menuItems');
            menuContainer.innerHTML = restaurant.menu.map((item, index) => `
                <div class="menu-item" onclick="addToCart(${index})">
                    <img src="${item.image}" alt="${item.name}" class="menu-item-image">
                    <div class="menu-item-details">
                        <div>
                            <div class="menu-item-header">
                                <h4 class="menu-item-name">${item.name}</h4>
                                <button class="add-btn" onclick="event.stopPropagation(); addToCart(${index})">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <p class="menu-item-desc">${item.desc}</p>
                        </div>
                        <span class="menu-item-price">$${item.price.toFixed(2)}</span>
                    </div>
                </div>
            `).join('');
            
            showPage('menuPage');
        }
        
        // Add to Cart
        function addToCart(itemIndex) {
            const item = currentRestaurant.menu[itemIndex];
            const existing = cart.find(c => c.name === item.name && c.restaurant === currentRestaurant.name);
            
            if (existing) {
                existing.qty++;
            } else {
                cart.push({
                    ...item,
                    restaurant: currentRestaurant.name,
                    qty: 1
                });
            }
            
            updateCart();
            
            // Visual feedback
            const btn = event.target.closest('.add-btn');
            btn.style.transform = 'scale(0.8)';
            setTimeout(() => btn.style.transform = 'scale(1)', 200);
        }
        
        // Update Cart
        function updateCart() {
            const count = cart.reduce((sum, item) => sum + item.qty, 0);
            const total = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            
            document.getElementById('cartCount').textContent = count;
            document.getElementById('cartTotal').textContent = '$' + total.toFixed(2);
            document.getElementById('cartBar').classList.toggle('hidden', count === 0);
            
            // Update cart page
            renderCart();
        }
        
        // Render Cart
        function renderCart() {
            const container = document.getElementById('cartItems');
            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-shopping-basket"></i>
                        <h3>Your cart is empty</h3>
                        <p>Add some delicious Kiwi food to get started!</p>
                    </div>
                `;
            } else {
                container.innerHTML = cart.map((item, index) => `
                    <div class="cart-item">
                        <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">$${item.price.toFixed(2)} each</div>
                            <div class="quantity-control">
                                <button class="qty-btn" onclick="updateQty(${index}, -1)">-</button>
                                <span class="qty-value">${item.qty}</span>
                                <button class="qty-btn" onclick="updateQty(${index}, 1)">+</button>
                            </div>
                        </div>
                        <div style="font-weight: 700; color: var(--primary);">
                            $${(item.price * item.qty).toFixed(2)}
                        </div>
                    </div>
                `).join('');
            }
            
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            const total = subtotal + 5.99 + 2.99;
            document.getElementById('subtotal').textContent = '$' + subtotal.toFixed(2);
            document.getElementById('totalPrice').textContent = '$' + total.toFixed(2);
        }
        
        // Update Quantity
        function updateQty(index, change) {
            cart[index].qty += change;
            if (cart[index].qty <= 0) {
                cart.splice(index, 1);
            }
            updateCart();
        }
        
        // Checkout
        function checkout() {
            if (cart.length === 0) return;
            
            alert('Order placed! Your KaiKart is on the way! ðŸššðŸ‡³ðŸ‡¿');
            cart = [];
            updateCart();
            showPage('foodApp');
        }
        
        // Driver Onboarding Steps
        let currentDriverStep = 1;
        
        function nextDriverStep(step) {
            document.getElementById(`driverStep${currentDriverStep}`).classList.add('hidden');
            document.getElementById(`driverStep${step}`).classList.remove('hidden');
            
            document.getElementById(`step${currentDriverStep}`).classList.remove('active');
            document.getElementById(`step${currentDriverStep}`).classList.add('completed');
            document.getElementById(`step${step}`).classList.add('active');
            
            currentDriverStep = step;
            window.scrollTo(0, 0);
        }
        
        function prevDriverStep(step) {
            document.getElementById(`driverStep${currentDriverStep}`).classList.add('hidden');
            document.getElementById(`driverStep${step}`).classList.remove('hidden');
            
            document.getElementById(`step${currentDriverStep}`).classList.remove('active');
            document.getElementById(`step${step}`).classList.remove('completed');
            document.getElementById(`step${step}`).classList.add('active');
            
            currentDriverStep = step;
            window.scrollTo(0, 0);
        }
        
        // Form Handlers
        function handleEaterSignup(e) {
            e.preventDefault();
            showToast('Account created successfully! Welcome to KaiKart.');
            setTimeout(() => enterFoodApp(), 2000);
        }
        
        function handleMerchantSignup(e) {
            e.preventDefault();
            showToast('Business profile saved! Continue to banking setup.');
        }
        
        function handleLogin(e) {
            e.preventDefault();
            showToast('Welcome back!');
            setTimeout(() => showPage('landingPage'), 1000);
        }
        
        function submitDriverApplication() {
            showToast('Application submitted! We\'ll review within 3-5 days.');
            setTimeout(() => showPage('landingPage'), 2000);
        }
        
        // Utilities
        function simulateUpload(element) {
            element.innerHTML = '<i class="fas fa-spinner fa-spin" style="font-size: 48px; color: var(--primary);"></i><p><strong>Uploading...</strong></p>';
            setTimeout(() => {
                element.innerHTML = '<i class="fas fa-check-circle" style="font-size: 48px; color: var(--success);"></i><p><strong>Upload Complete!</strong></p><p class="upload-hint">File verified successfully</p>';
                element.style.borderColor = 'var(--success)';
                element.style.background = '#E8F5E9';
            }, 1500);
        }
        
        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Check for hash in URL
            const hash = window.location.hash.replace('#', '');
            if (hash && document.getElementById(hash)) {
                showPage(hash);
            }
        });
    </script>
